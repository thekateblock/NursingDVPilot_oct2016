---
title: "Analyses for Nursing Pilot Oct 2016"
author: "Kate Block"
date: "`r format(Sys.Date())`"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r, message=FALSE}
library (tidyverse)
library (ggplot2)
library(knitr)
library(Hmisc)
```

## reading file

```{r, message=FALSE}
CLEAN_hetero <- read_csv("/Users/KatharinaBlock/Desktop/Git_REPOS/NursingDVPilot_oct2016/Nursing2pilot_clean_hetero.csv")
```

Making a mean overview
```{r, echo=FALSE, warning=FALSE}
Mean_overview <- CLEAN_hetero %>% group_by(gender) %>% summarise(M_rate = mean(rate_men_nursing), Sd_rate= sd(rate_men_nursing), M_positive= mean(male_nurse_positive), Sd_positive=sd(male_nurse_positive), M_communal = mean(communal_values),Sd_communal = sd(communal_values), M_agentic= mean(agentic_values),  Sd_agentic= sd(agentic_values), M_interest = mean(interest_comp), Sd_interest = sd (interest_comp), M_rankNurse = mean(rank_nurse), Sd_rankNurse = sd (rank_nurse), M_SNoverlap = mean(nursing_overlap), Sd_SNoverlap = sd(nursing_overlap), M_fit= mean(fit_nursing), Sd_fit= sd(fit_nursing), participants = n ())

M2 <- reshape(Mean_overview, 
  varying = c("M_rate","Sd_rate", "M_positive", "Sd_positive", "M_communal", "Sd_communal", "M_agentic", "Sd_agentic", "M_interest", "Sd_interest", "M_rankNurse", "Sd_rankNurse", "M_SNoverlap", "Sd_SNoverlap", "M_fit", "Sd_fit", "participants"), 
  v.names = "Score",
  timevar = "vars", 
  times = c("M_rate","Sd_rate", "M_positive", "Sd_positive", "M_communal", "Sd_communal", "M_agentic", "Sd_agentic", "M_interest", "Sd_interest", "M_rankNurse", "Sd_rankNurse", "M_SNoverlap", "Sd_SNoverlap", "M_fit", "Sd_fit", "participants"), 
  new.row.names = 1:1000,
  direction = "long") %>% 
  filter (gender != "Neither reflects my gender identity")

pretty <- M2 %>% select (-id) %>% 
  spread(gender, Score)

pretty %>% arrange (desc(Female)) %>% kable 
```

# Correlations

## Correlations for FIT measure:

LOOKING GREAT!

```{r}
fitmeasure <- CLEAN_hetero[, c("fit1","fit2","fit3", "fit4", "fit5", "fit6")]
corrs1 <- rcorr (as.matrix(fitmeasure))
corrs1$r %>% kable ()
corrs1$P %>% kable ()
```


## Correlations for INTEREST Measure:

LOOKING GREAT!

```{r}
interestmeasure <- CLEAN_hetero[, c("interest_nursing","enjoy_nursing","imagine_nursing")]
corrs2 <- rcorr (as.matrix(fitmeasure))
corrs2$r %>% kable ()
corrs2$P %>% kable ()
```


## Overall correlation (MEN AND WOMEN)

I display these in different ways
NOTES:

* Communal values are related to all FIT, interest and rank. But MORE to fit and rank than interest.
* We get gender differences in all three FIT, interest and rank
* interestingly we don't get gender differences in communal values???

```{r, warning=FALSE, message=FALSE, echo=FALSE}

library("PerformanceAnalytics")
my_data <- CLEAN_hetero[, c("gender_num","rate_men_nursing","male_nurse_positive","communal_values", "agentic_values", "rank_nurse", "fit_nursing", "interest_comp")]

corrs3 <- rcorr (as.matrix(my_data))

flattenCorrMatrix <- function(cormat, pmat) {
  ut <- upper.tri(cormat)
  data.frame(
    row = rownames(cormat)[row(cormat)[ut]],
    column = rownames(cormat)[col(cormat)[ut]],
    cor  =(cormat)[ut],
    p = pmat[ut]
    )
}
corrs3$r %>% kable ()
corrs3$P %>% kable ()

chart.Correlation(my_data, histogram=TRUE, pch=19)

flattenCorrMatrix(corrs3$r, corrs3$P) %>% kable()
```

# Correlations JUST FOR MEN!

```{r, warning=FALSE, echo=FALSE}
MENONLY <- CLEAN_hetero %>% filter(gender == "Male") 

my_dataMEN <- MENONLY[, c("rate_men_nursing","male_nurse_positive","communal_values", "agentic_values", "rank_nurse", "fit_nursing", "interest_comp")]

corrs4 <- rcorr (as.matrix(my_dataMEN))

flattenCorrMatrix <- function(cormat, pmat) {
  ut <- upper.tri(cormat)
  data.frame(
    row = rownames(cormat)[row(cormat)[ut]],
    column = rownames(cormat)[col(cormat)[ut]],
    cor  =(cormat)[ut],
    p = pmat[ut]
    )
}
corrs4$r %>% kable ()
corrs4$P %>% kable ()

chart.Correlation(my_dataMEN, histogram=TRUE, pch=19)

flattenCorrMatrix(corrs4$r, corrs4$P) %>% kable()
```



